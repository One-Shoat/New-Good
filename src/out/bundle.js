(()=>{function f(e,t,a,o,p,d){let h=new Image;h.src=t,e.drawImage(h,a,o,p,d)}function v(e,t,a,o,p,d){let h="";t=="roboto"&&(h="24px Roboto"),t=="arial"&&(h="24px Arial"),e.font=h,e.fillStyle=a,e.fillText(o,p,d)}var g={i:0},M=[],w=document.getElementById("game");function _(e,t){for(let a=0;a<e;a++)t=="bugenner"&&i.push({id:a,x:Math.floor(Math.random()*w.width),y:Math.floor(Math.random()*w.height),img:"./assets/sprite_0.png",type:"bugenner",life:3}),t=="singulary"&&i.push({id:a,x:Math.floor(Math.random()*w.width),y:Math.floor(Math.random()*w.height),img:"https://media.discordapp.net/attachments/1087504461364207656/1095427124929769472/Sprite-0005.png?width=46&height=46",type:"singulary",life:5}),t=="rocketener"&&i.push({id:a,x:Math.floor(Math.random()*w.width),y:Math.floor(Math.random()*w.height),img:"./assets/rocketener.png",type:"rocketener",life:2})}function T(){M.forEach(t=>clearTimeout(t)),M=[];let e=0;for(g.i=0;g.i<1e3;g.i++){let t=g.i;if(t<=10){let a=setTimeout(()=>{_(t*2,"bugenner"),_(t,"singulary")},e);M.push(a),e+=15e3}if(t>=10&&t<=30){let a=setTimeout(()=>{_(t,"singulary"),_(t/2,"rocketener")},e);M.push(a),e+=15e3}}}var U=new Audio("./assets/demage.wav");var r=document.getElementById("game"),s=r.getContext("2d"),i=[];r.width=window.innerWidth;r.height=window.innerHeight;var l=0,m,u,x=3,I=!1,y=!1,n=[{type:"a",name:"a",x:-999,y:-999}],k={x:r.width/2,y:r.height/2},E=15;addEventListener("mousedown",e=>{if(m=e.clientX,u=e.clientY,I=!0,console.log(n),c(m,u,r.width-16,r.height-16,.1)){if(y==!0)return y=!1;y=!0}if(y==!0&&c(m,u,r.width-64,r.height-256,.05))return l<30?alert("pobre fudido"):(l-=30,n.push({type:"graminea",name:"graminea",x:-999,y:-999,life:3}));if(y==!0&&c(m,u,r.width-64,r.height-150,.05))return l<30?alert("pobre fudido"):(l-=30,n.push({type:"cerca",name:"cerca",x:-999,y:-999,life:7}));if(y==!0&&c(m,u,r.width-64,r.height-220,.05))return l<50?alert("pobre fudido"):(l-=50,n.push({type:"stoneenner",name:"stoneenner",x:-999,y:-999,life:5}));n[n.length-1].type!="a"&&(n[n.length-1].type="pressed");for(let t=0;t<i.length;t++)if(i[t].type=="bugenner"&&(i[t].life==2&&(i[t].img="./assets/sprite_1.png"),i[t].life==1&&(i[t].img="./assets/sprite_2.png")),i[t].type=="singulary"&&(i[t].life==4&&(i[t].img="./assets/sprite_singulary0.png"),i[t].life==3&&(i[t].img="./assets/sprite_singulary1.png"),i[t].life==2&&(i[t].img="./assets/sprite_singulary2.png"),i[t].life==1&&(i[t].img="./assets/sprite_singulary3.png")),I&&c(i[t].x,i[t].y,m,u,.06)){i[t].life-=1,l+=1;break}});addEventListener("mouseup",e=>{m=0,u=0,I=!1});addEventListener("mousemove",e=>{if(n[n.length-1].type!="pressed"&&n[n.length-1].type!="a")return n[n.length-1].x=e.clientX,n[n.length-1].y=e.clientY});function C(){x<=0&&(i=[],g.i=0,f(s,"./assets/gameover.png",0,0,r.width,r.height),setTimeout(()=>{x=3,l<14?l-=l:l-=15,g.i=0,T()},2e3))}setInterval(()=>{E--},1e3);setInterval(()=>{E=15},15e3);function c(e,t,a,o,p){let d=Math.abs(a-e),h=Math.abs(o-t);return d<=p*r.width&&h<=p*r.height}function D(e,t,a,o,p,d,h){let b=a-e,A=o-t,Y=Math.sqrt(b*b+A*A),j=(d+h)/4;return Y<j+p*r.width}T();function X(){requestAnimationFrame(X),s.clearRect(0,0,r.width,r.height),v(s,"roboto","red",`Hordas em: ${E}`,800,70);for(let e=0;e<i.length;e++){let t=20,a=20,o=0,p=r.width/2-i[e].x,d=r.height/2-i[e].y;i[e].type=="bugenner"&&(o=.008),i[e].type=="singulary"&&(o=.004),i[e].type=="rocketener"&&(o=.01);let h=i[e].x+p*o,b=i[e].y+d*o;i[e].x=h,i[e].y=b,i[e].life<0&&i.splice(e,1),D(i[e].x,i[e].y,r.width/2,r.height/2,.04,t,a)&&(i[e].type=="bugenner"&&(x-=1),i[e].type=="singulary"&&(x-=.5),i[e].type=="rocketener"&&(x-=1.5),U.play(),i.splice(e,1)),f(s,i[e].img,i[e].x,i[e].y,50,50)}for(let e=0;e<x;e++)f(s,"https://cdn.discordapp.com/attachments/1087504461364207656/1095433836432740362/Coracao_cheio.png",e*50,0,150,150);y==!0&&(s.globalAlpha=.9,f(s,"https://media.discordapp.net/attachments/1087503910098436158/1095756195362508810/sprite__grama_de_pontos0_1.png?width=120&height=120",r.width-128,r.height-256,128,128),s.globalAlpha=1);for(let e=0;e<n.length;e++){n[e].life<0&&n.splice(e,1);for(let t=0;t<i.length;t++)c(n[e].x,n[e].y,i[t].x,i[t].y,.1)&&n[e].type=="pressed"&&n[e].name=="stoneenner"&&(i.splice(t,1),n[e].life-=.5),c(n[e].x,n[e].y,i[t].x,i[t].y,.05)&&n[e].type=="pressed"&&(i[t].type=="bugenner"&&(n[e].life-=1),i[t].type=="singulary"&&(n[e].life-=.5),i.splice(t,1));if(n[e].type=="graminea"||n[e].type=="pressed"&&n[e].name=="graminea"){n[e].lastUpdateTime||(n[e].lastUpdateTime=Date.now());let t=Date.now();t-n[e].lastUpdateTime>=3e3&&(n[e].lastUpdateTime=t,l+=1),f(s,"./assets/graminea.png",n[e].x,n[e].y,32,32)}(n[e].type=="stoneenner"||n[e].type=="pressed"&&n[e].name=="stoneenner")&&f(s,"./assets/Coracao_cheio.png",n[e].x,n[e].y,64,64),(n[e].type=="cerca"||n[e].type=="pressed"&&n[e].name=="cerca")&&f(s,"./assets/cerca.png",n[e].x,n[e].y,32,32)}k.y=Math.floor(Math.random()*21)+r.height/2-10,v(s,"roboto","blue",`Points: ${l}`,500,70),f(s,"https://media.discordapp.net/attachments/1087504461364207656/1095456781418893433/image.png?width=120&height=120",r.width-128,r.height-128,128,128),f(s,"https://media.discordapp.net/attachments/1087504461364207656/1097932946888982558/KOtsu-export.png?width=287&height=287",k.x,k.y,50,50),C()}X();})();
