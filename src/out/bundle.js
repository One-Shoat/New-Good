(()=>{function d(e,t,s,l,p,f){let o=new Image;o.src=t,e.drawImage(o,s,l,p,f)}function U(e,t,s,l,p,f){let o="";t=="roboto"&&(o="24px Roboto"),t=="arial"&&(o="24px Arial"),e.font=o,e.fillStyle=s,e.fillText(l,p,f)}var g={i:0},_=[],b=document.getElementById("game");function E(e,t){for(let s=0;s<e;s++)t=="bugenner"&&i.push({id:s,x:Math.floor(Math.random()*b.width),y:Math.floor(Math.random()*b.height),img:"./assets/sprite_0.png",type:"bugenner",life:3}),t=="singulary"&&i.push({id:s,x:Math.floor(Math.random()*b.width),y:Math.floor(Math.random()*b.height),img:"https://media.discordapp.net/attachments/1087504461364207656/1095427124929769472/Sprite-0005.png?width=46&height=46",type:"singulary",life:5})}function M(){_.forEach(t=>clearTimeout(t)),_=[];let e=0;for(g.i=0;g.i<1e3;g.i++){let t=g.i;if(g.i<50){let s=setTimeout(()=>{E(t*2,"bugenner"),E(t,"singulary")},e);_.push(s),e+=12e3}}}var Y=new Audio("./assets/demage.wav"),A=Y;var a=document.getElementById("game"),r=a.getContext("2d"),i=[];a.width=window.innerWidth;a.height=window.innerHeight;var h=0,m,u,w=3,T=!1,y=!1,n=[{type:"a",name:"a",x:-999,y:-999}];addEventListener("mousedown",e=>{if(m=e.clientX,u=e.clientY,T=!0,console.log(n),c(m,u,a.width-16,a.height-16,.1)){if(y==!0)return y=!1;y=!0}if(y==!0&&c(m,u,a.width-64,a.height-256,.05))return h<30?alert("pobre fudido"):(h-=30,n.push({type:"graminea",name:"graminea",x:-999,y:-999,life:3}));if(y==!0&&c(m,u,a.width-64,a.height-220,.05))return h<0?alert("pobre fudido"):(h-=50,n.push({type:"stoneenner",name:"stoneenner",x:-999,y:-999,life:5}));n[n.length-1].type!="a"&&(n[n.length-1].type="pressed");for(let t=0;t<i.length;t++)if(i[t].type=="bugenner"&&(i[t].life==2&&(i[t].img="./assets/sprite_1.png"),i[t].life==1&&(i[t].img="./assets/sprite_2.png")),i[t].type=="singulary"&&(i[t].life==4&&(i[t].img="./assets/sprite_singulary0.png"),i[t].life==3&&(i[t].img="./assets/sprite_singulary1.png"),i[t].life==2&&(i[t].img="./assets/sprite_singulary2.png"),i[t].life==1&&(i[t].img="./assets/sprite_singulary3.png")),T&&c(i[t].x,i[t].y,m,u,.06)){i[t].life-=1,h+=1;break}});addEventListener("mouseup",e=>{m=0,u=0,T=!1});addEventListener("mousemove",e=>{if(n[n.length-1].type!="pressed"&&n[n.length-1].type!="a")return n[n.length-1].x=e.clientX,n[n.length-1].y=e.clientY});function j(){w<=0&&(i=[],g.i=0,d(r,"./assets/gameover.png",0,0,a.width,a.height),setTimeout(()=>{w=3,h<14?h-=h:h-=15,g.i=0,M()},2e3))}function c(e,t,s,l,p){let f=Math.abs(s-e),o=Math.abs(l-t);return f<=p*a.width&&o<=p*a.height}function C(e,t,s,l,p,f,o){let x=s-e,v=l-t,I=Math.sqrt(x*x+v*v),X=(f+o)/4;return I<X+p*a.width}M();function D(){requestAnimationFrame(D),r.clearRect(0,0,a.width,a.height);for(let e=0;e<i.length;e++){let t=20,s=20,l=0,p=a.width/2-i[e].x,f=a.height/2-i[e].y;i[e].type=="bugenner"&&(l=.008),i[e].type=="singulary"&&(l=.004);let o=i[e].x+p*l,x=i[e].y+f*l;i[e].x=o,i[e].y=x,i[e].life<0&&i.splice(e,1),C(i[e].x,i[e].y,a.width/2,a.height/2,.04,t,s)&&(i[e].type=="bugenner"&&(w-=1),i[e].type=="singulary"&&(w-=.5),A.play(),i.splice(e,1)),d(r,i[e].img,i[e].x,i[e].y,50,50)}for(let e=0;e<w;e++)d(r,"https://cdn.discordapp.com/attachments/1087504461364207656/1095433836432740362/Coracao_cheio.png",e*50,0,150,150);y==!0&&(r.globalAlpha=.9,d(r,"https://media.discordapp.net/attachments/1087503910098436158/1095756195362508810/sprite__grama_de_pontos0_1.png?width=120&height=120",a.width-128,a.height-256,128,128),r.globalAlpha=1);for(let e=0;e<n.length;e++){n[e].life<0&&n.splice(e,1);for(let t=0;t<i.length;t++)if(c(n[e].x,n[e].y,i[t].x,i[t].y,.05)&&n[e].type=="pressed"&&(i[t].type=="bugenner"&&(n[e].life-=1),i[t].type=="singulary"&&(n[e].life-=.5),i.splice(t,1)),c(n[e].x,n[e].y,i[t].x,i[t].y,.05)&&n[e].type=="pressed"){n[e].lastUpdateTime||(n[e].lastUpdateTime=Date.now());let s=Date.now();s-n[e].lastUpdateTime>=4e3&&(n[e].lastUpdateTime=s,i[t].life-=1)}if(n[e].type=="graminea"||n[e].type=="pressed"&&n[e].name=="graminea"){n[e].lastUpdateTime||(n[e].lastUpdateTime=Date.now());let t=Date.now();t-n[e].lastUpdateTime>=3e3&&(n[e].lastUpdateTime=t,h+=1),d(r,"./assets/graminea.png",n[e].x,n[e].y,32,32)}(n[e].type=="stoneenner"||n[e].type=="pressed"&&n[e].name=="stoneenner")&&d(r,"./assets/Coracao_cheio.png",n[e].x,n[e].y,64,64)}d(r,"https://media.discordapp.net/attachments/1087504461364207656/1096189471885639750/Sprite-0001-exp40rt.png?width=300&height=300",a.width/2+500,a.height/2-300,64,64),U(r,"roboto","blue",`Points: ${h}`,500,70),d(r,"https://media.discordapp.net/attachments/1087504461364207656/1095456781418893433/image.png?width=120&height=120",a.width-128,a.height-128,128,128),d(r,"https://media.discordapp.net/attachments/1091018990089932850/1093625787413966903/New_Piskel_20.png?width=128&height=128",a.width/2,a.height/2,50,50),j()}D();})();
